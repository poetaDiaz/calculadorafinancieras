<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Financiera - Taller de Inter√©s Simple y Compuesto</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .problem-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease;
        }
        
        .problem-section:hover {
            transform: translateY(-2px);
        }
        
        .problem-title {
            color: #4a5568;
            font-weight: 600;
            font-size: 1.2em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .problem-number {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: bold;
        }
        
        .calc-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        label {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 5px;
        }
        
        input, select {
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .result-box {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
            margin-top: 15px;
        }
        
        .formula-display {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 14px;
            color: #4a5568;
        }
        
        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease;
            margin: 10px 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .download-section {
            text-align: center;
            margin-top: 40px;
            padding: 30px;
            background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
            border-radius: 15px;
        }
        
        @media (max-width: 768px) {
            .calc-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Calculadora Financiera</h1>
            <p>Taller de Inter√©s Simple y Compuesto</p>
        </div>

        <!-- Problema 1 -->
        <div class="problem-section">
            <div class="problem-title">
                <div class="problem-number">1</div>
                Cuenta de Ahorros con Inter√©s Simple
            </div>
            <p><strong>Pregunta:</strong> Un ahorrador realiza dep√≥sitos escalonados al 0.75% quincenal. ¬øCu√°nto tendr√° ahorrado al cabo de 2 a√±os?</p>
            
            <div class="calc-grid">
                <div class="input-group">
                    <label>Tasa quincenal (%):</label>
                    <input type="number" id="tasa1" value="0.75" step="0.01">
                </div>
                <div class="input-group">
                    <label>Per√≠odo total (a√±os):</label>
                    <input type="number" id="periodo1" value="2" step="0.1">
                </div>
            </div>
            
            <button class="btn" onclick="calcularProblema1()">Calcular</button>
            
            <div id="result1" class="result-box" style="display: none;"></div>
            <div id="formula1" class="formula-display" style="display: none;"></div>
        </div>

        <!-- Problema 2 -->
        <div class="problem-section">
            <div class="problem-title">
                <div class="problem-number">2</div>
                An√°lisis de Ofertas de Venta
            </div>
            <p><strong>Pregunta:</strong> ¬øQu√© oferta es m√°s conveniente para vender un terreno de $180 millones con rendimiento del 20% anual?</p>
            
            <div class="calc-grid">
                <div class="input-group">
                    <label>Valor presente del terreno (millones):</label>
                    <input type="number" id="valorTerreno" value="180">
                </div>
                <div class="input-group">
                    <label>Tasa de rendimiento anual (%):</label>
                    <input type="number" id="tasaRendimiento" value="20" step="0.1">
                </div>
            </div>
            
            <button class="btn" onclick="calcularProblema2()">Calcular</button>
            
            <div id="result2" class="result-box" style="display: none;"></div>
            <div id="formula2" class="formula-display" style="display: none;"></div>
        </div>

        <!-- Problema 3 -->
        <div class="problem-section">
            <div class="problem-title">
                <div class="problem-number">3</div>
                Ahorro para Maquinaria
            </div>
            <p><strong>Pregunta:</strong> ¬øCon cu√°nto abrir cuenta de ahorros al 18% anual trimestre vencido para comprar maquinaria en 1.5 a√±os?</p>
            
            <div class="calc-grid">
                <div class="input-group">
                    <label>Precio nueva maquinaria (millones):</label>
                    <input type="number" id="precioNueva" value="50">
                </div>
                <div class="input-group">
                    <label>Valor venta maquinaria usada (millones):</label>
                    <input type="number" id="valorUsada" value="25">
                </div>
                <div class="input-group">
                    <label>Tasa anual (%):</label>
                    <input type="number" id="tasaAnual3" value="18">
                </div>
                <div class="input-group">
                    <label>Tiempo (a√±os):</label>
                    <input type="number" id="tiempo3" value="1.5" step="0.1">
                </div>
            </div>
            
            <button class="btn" onclick="calcularProblema3()">Calcular</button>
            
            <div id="result3" class="result-box" style="display: none;"></div>
            <div id="formula3" class="formula-display" style="display: none;"></div>
        </div>

        <!-- Problema 4 -->
        <div class="problem-section">
            <div class="problem-title">
                <div class="problem-number">4</div>
                Cuenta con Movimientos
            </div>
            <p><strong>Pregunta:</strong> Dep√≥sito inicial $15 millones al 14% anual mes vencido, con retiros y dep√≥sitos posteriores.</p>
            
            <div class="calc-grid">
                <div class="input-group">
                    <label>Dep√≥sito inicial (millones):</label>
                    <input type="number" id="depositoInicial" value="15">
                </div>
                <div class="input-group">
                    <label>Tasa anual (%):</label>
                    <input type="number" id="tasaAnual4" value="14">
                </div>
            </div>
            
            <button class="btn" onclick="calcularProblema4()">Calcular</button>
            
            <div id="result4" class="result-box" style="display: none;"></div>
            <div id="formula4" class="formula-display" style="display: none;"></div>
        </div>

        <!-- Problema 5 -->
        <div class="problem-section">
            <div class="problem-title">
                <div class="problem-number">5</div>
                Inter√©s Compuesto Variable
            </div>
            <p><strong>Pregunta:</strong> Inversi√≥n $18 millones por 5 a√±os con tasas variables trimestrales.</p>
            
            <div class="calc-grid">
                <div class="input-group">
                    <label>Inversi√≥n inicial (millones):</label>
                    <input type="number" id="inversion5" value="18">
                </div>
                <div class="input-group">
                    <label>Tiempo total (a√±os):</label>
                    <input type="number" id="tiempo5" value="5">
                </div>
            </div>
            
            <button class="btn" onclick="calcularProblema5()">Calcular</button>
            
            <div id="result5" class="result-box" style="display: none;"></div>
            <div id="formula5" class="formula-display" style="display: none;"></div>
        </div>

        <!-- Problema 6 -->
        <div class="problem-section">
            <div class="problem-title">
                <div class="problem-number">6</div>
                Valor Presente de Pr√©stamo
            </div>
            <p><strong>Pregunta:</strong> ¬øDe cu√°nto fue el pr√©stamo si se pagaron $15 millones al final de 5 a√±os al 1.2% efectivo mensual?</p>
            
            <div class="calc-grid">
                <div class="input-group">
                    <label>Valor final pagado (millones):</label>
                    <input type="number" id="valorFinal6" value="15">
                </div>
                <div class="input-group">
                    <label>Tasa efectiva mensual (%):</label>
                    <input type="number" id="tasaMensual6" value="1.2" step="0.1">
                </div>
                <div class="input-group">
                    <label>Tiempo (a√±os):</label>
                    <input type="number" id="tiempo6" value="5">
                </div>
            </div>
            
            <button class="btn" onclick="calcularProblema6()">Calcular</button>
            
            <div id="result6" class="result-box" style="display: none;"></div>
            <div id="formula6" class="formula-display" style="display: none;"></div>
        </div>

        <!-- Problema 7 -->
        <div class="problem-section">
            <div class="problem-title">
                <div class="problem-number">7</div>
                Equivalencia de Tasas Anticipadas
            </div>
            <p><strong>Pregunta:</strong> Convertir tasas nominales anticipadas a tasa efectiva mensual.</p>
            
            <button class="btn" onclick="calcularProblema7()">Calcular</button>
            
            <div id="result7" class="result-box" style="display: none;"></div>
            <div id="formula7" class="formula-display" style="display: none;"></div>
        </div>

        <!-- Problema 8 -->
        <div class="problem-section">
            <div class="problem-title">
                <div class="problem-number">8</div>
                C√°lculo de Tasa de Inter√©s
            </div>
            <p><strong>Pregunta:</strong> ¬øQu√© tasa se aplic√≥ a $30 millones para obtener $38 millones en 5 a√±os?</p>
            
            <div class="calc-grid">
                <div class="input-group">
                    <label>Capital inicial (millones):</label>
                    <input type="number" id="capitalInicial8" value="30">
                </div>
                <div class="input-group">
                    <label>Capital final (millones):</label>
                    <input type="number" id="capitalFinal8" value="38">
                </div>
                <div class="input-group">
                    <label>Tiempo (a√±os):</label>
                    <input type="number" id="tiempo8" value="5">
                </div>
            </div>
            
            <button class="btn" onclick="calcularProblema8()">Calcular</button>
            
            <div id="result8" class="result-box" style="display: none;"></div>
            <div id="formula8" class="formula-display" style="display: none;"></div>
        </div>

        <!-- Problema 9 -->
        <div class="problem-section">
            <div class="problem-title">
                <div class="problem-number">9</div>
                Equivalencia de Tasas Efectivas
            </div>
            <p><strong>Pregunta:</strong> Convertir tasas efectivas peri√≥dicas a tasa efectiva trimestral.</p>
            
            <button class="btn" onclick="calcularProblema9()">Calcular</button>
            
            <div id="result9" class="result-box" style="display: none;"></div>
            <div id="formula9" class="formula-display" style="display: none;"></div>
        </div>

        <!-- Problema 10 -->
        <div class="problem-section">
            <div class="problem-title">
                <div class="problem-number">10</div>
                Dep√≥sito a T√©rmino Fijo
            </div>
            <p><strong>Pregunta:</strong> ¬øCu√°nto recibir√° por $20 millones a 5 a√±os al 5% efectivo semestral?</p>
            
            <div class="calc-grid">
                <div class="input-group">
                    <label>Inversi√≥n inicial (millones):</label>
                    <input type="number" id="inversion10" value="20">
                </div>
                <div class="input-group">
                    <label>Tasa efectiva semestral (%):</label>
                    <input type="number" id="tasaSemestral10" value="5">
                </div>
                <div class="input-group">
                    <label>Tiempo (a√±os):</label>
                    <input type="number" id="tiempo10" value="5">
                </div>
            </div>
            
            <button class="btn" onclick="calcularProblema10()">Calcular</button>
            
            <div id="result10" class="result-box" style="display: none;"></div>
            <div id="formula10" class="formula-display" style="display: none;"></div>
        </div>

        <div class="download-section">
            <h3>üìà Descarga la Hoja de C√°lculo Excel</h3>
            <p>Obt√©n todas las f√≥rmulas y c√°lculos en formato Excel para tu referencia</p>
            <button class="btn" onclick="descargarExcel()">üì• Descargar Excel</button>
            <button class="btn" onclick="exportarResultados()">üìä Exportar Resultados</button>
        </div>
    </div>

    <script>
        // Funci√≥n para formatear n√∫meros como moneda colombiana
        function formatoCOP(numero) {
            return new Intl.NumberFormat('es-CO', {
                style: 'currency',
                currency: 'COP',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(numero);
        }

        // Problema 1: Inter√©s Simple con dep√≥sitos escalonados
        function calcularProblema1() {
            const tasa = parseFloat(document.getElementById('tasa1').value) / 100; // 0.75% quincenal
            const depositos = [
                {monto: 750000, tiempo: 4.5}, // 4 meses 15 d√≠as
                {monto: 950000, tiempo: 6.5}, // 6 meses 15 d√≠as
                {monto: 1200000, tiempo: 9.5}, // 9 meses 15 d√≠as
                {monto: 1650000, tiempo: 15}, // 15 meses
                {monto: 1700000, tiempo: 18}  // 18 meses
            ];
            
            let montoTotal = 0;
            let detalles = [];
            
            depositos.forEach((deposito, i) => {
                const tiempoEnQuincenas = (24 - deposito.tiempo) * 2; // Tiempo que permanece hasta 24 meses
                const intereses = deposito.monto * tasa * tiempoEnQuincenas;
                const montoFinal = deposito.monto + intereses;
                montoTotal += montoFinal;
                
                detalles.push(`Dep√≥sito ${i+1}: ${formatoCOP(deposito.monto)} por ${tiempoEnQuincenas} quincenas = ${formatoCOP(montoFinal)}`);
            });
            
            // Capital necesario para obtener el mismo resultado
            const tiempoTotalQuincenas = 24 * 2; // 2 a√±os en quincenas
            const capitalNecesario = montoTotal / (1 + tasa * tiempoTotalQuincenas);
            
            document.getElementById('result1').innerHTML = `
                <strong>Monto total ahorrado:</strong> ${formatoCOP(montoTotal)}<br>
                <strong>Capital inicial equivalente:</strong> ${formatoCOP(capitalNecesario)}
            `;
            
            document.getElementById('formula1').innerHTML = `
                <strong>F√≥rmulas utilizadas:</strong><br>
                ‚Ä¢ Inter√©s Simple: I = C √ó i √ó t<br>
                ‚Ä¢ Monto Final: M = C + I = C(1 + it)<br>
                ‚Ä¢ Detalles por dep√≥sito:<br>
                ${detalles.join('<br>')}
            `;
            
            document.getElementById('result1').style.display = 'block';
            document.getElementById('formula1').style.display = 'block';
        }

        // Problema 2: An√°lisis de ofertas
        function calcularProblema2() {
            const valorPresente = parseFloat(document.getElementById('valorTerreno').value) * 1000000;
            const tasa = parseFloat(document.getElementById('tasaRendimiento').value) / 100;
            
            // Oferta A: $183M con cuota inicial 28% a 6 meses
            const cuotaInicialA = 183000000 * 0.28;
            const saldoA = 183000000 - cuotaInicialA;
            const vpA = cuotaInicialA + (saldoA / Math.pow(1 + tasa, 0.5));
            
            // Oferta B: $184M con cuota inicial 25% a 12 meses
            const cuotaInicialB = 184000000 * 0.25;
            const saldoB = 184000000 - cuotaInicialB;
            const vpB = cuotaInicialB + (saldoB / Math.pow(1 + tasa, 1));
            
            // Oferta C: 50% de contado, saldo a 12 meses
            const contadoC = valorPresente * 0.5;
            const saldoC = valorPresente * 0.5;
            const vpC = contadoC + (saldoC / Math.pow(1 + tasa, 1));
            
            // Oferta D: 80% a 6 meses, saldo a 12 meses
            const pagoD1 = valorPresente * 0.8;
            const pagoD2 = valorPresente * 0.2;
            const vpD = (pagoD1 / Math.pow(1 + tasa, 0.5)) + (pagoD2 / Math.pow(1 + tasa, 1));
            
            const ofertas = [
                {nombre: 'A', vp: vpA, descripcion: '$183M, inicial 28%, saldo a 6 meses'},
                {nombre: 'B', vp: vpB, descripci√≥n: '$184M, inicial 25%, saldo a 12 meses'},
                {nombre: 'C', vp: vpC, descripci√≥n: '50% contado, saldo a 12 meses'},
                {nombre: 'D', vp: vpD, descripci√≥n: '80% a 6 meses, 20% a 12 meses'}
            ];
            
            const mejorOferta = ofertas.reduce((max, oferta) => oferta.vp > max.vp ? oferta : max);
            
            document.getElementById('result2').innerHTML = `
                <strong>Valores presentes:</strong><br>
                Oferta A: ${formatoCOP(vpA)}<br>
                Oferta B: ${formatoCOP(vpB)}<br>
                Oferta C: ${formatoCOP(vpC)}<br>
                Oferta D: ${formatoCOP(vpD)}<br>
                <strong>Mejor oferta: ${mejorOferta.nombre}</strong>
            `;
            
            document.getElementById('formula2').innerHTML = `
                <strong>F√≥rmula VP:</strong> VP = CF / (1 + i)^t<br>
                Donde: CF = Flujo de caja, i = tasa, t = tiempo
            `;
            
            document.getElementById('result2').style.display = 'block';
            document.getElementById('formula2').style.display = 'block';
        }

        // Problema 3: Ahorro para maquinaria
        function calcularProblema3() {
            const precioNueva = parseFloat(document.getElementById('precioNueva').value) * 1000000;
            const valorUsada = parseFloat(document.getElementById('valorUsada').value) * 1000000;
            const tasaAnual = parseFloat(document.getElementById('tasaAnual3').value) / 100;
            const tiempo = parseFloat(document.getElementById('tiempo3').value);
            
            // Monto necesario = Precio nueva - Valor venta usada
            const montoNecesario = precioNueva - valorUsada;
            
            // Tasa trimestral
            const tasaTrimestral = tasaAnual / 4;
            const trimestres = tiempo * 4;
            
            // Capital inicial necesario
            const capitalInicial = montoNecesario / Math.pow(1 + tasaTrimestral, trimestres);
            
            document.getElementById('result3').innerHTML = `
                <strong>Capital inicial necesario:</strong> ${formatoCOP(capitalInicial)}<br>
                <strong>Monto a obtener:</strong> ${formatoCOP(montoNecesario)}<br>
                <strong>Tasa trimestral:</strong> ${(tasaTrimestral * 100).toFixed(2)}%
            `;
            
            document.getElementById('formula3').innerHTML = `
                <strong>F√≥rmula:</strong> VP = VF / (1 + i)^n<br>
                VP = ${formatoCOP(montoNecesario)} / (1 + ${(tasaTrimestral * 100).toFixed(2)}%)^${trimestres}
            `;
            
            document.getElementById('result3').style.display = 'block';
            document.getElementById('formula3').style.display = 'block';
        }

        // Problema 4: Cuenta con movimientos
        function calcularProblema4() {
            const depositoInicial = parseFloat(document.getElementById('depositoInicial').value) * 1000000;
            const tasaAnual = parseFloat(document.getElementById('tasaAnual4').value) / 100;
            const tasaMensual = tasaAnual / 12;
            
            // A√±o 1: $15M al 14% anual
            const saldoAno1 = depositoInicial * Math.pow(1 + tasaMensual, 12);
            
            // Retira la mitad
            const retiro = saldoAno1 / 2;
            const saldoPostRetiro = saldoAno1 - retiro;
            
            // 6 meses despu√©s (saldo crece 6 meses)
            const saldoA6Meses = saldoPostRetiro * Math.pow(1 + tasaMensual, 6);
            
            // Deposita suma igual al saldo
            const nuevoDeposito = saldoA6Meses;
            const saldoPostDeposito = saldoA6Meses + nuevoDeposito;
            
            // 12 meses m√°s (cancela cuenta)
            const saldoFinal = saldoPostDeposito * Math.pow(1 + tasaMensual, 12);
            
            document.getElementById('result4').innerHTML = `
                <strong>Saldo al a√±o 1:</strong> ${formatoCOP(saldoAno1)}<br>
                <strong>Retiro (50%):</strong> ${formatoCOP(retiro)}<br>
                <strong>Saldo despu√©s retiro:</strong> ${formatoCOP(saldoPostRetiro)}<br>
                <strong>Saldo a 6 meses:</strong> ${formatoCOP(saldoA6Meses)}<br>
                <strong>Nuevo dep√≥sito:</strong> ${formatoCOP(nuevoDeposito)}<br>
                <strong>Saldo final (cancela cuenta):</strong> ${formatoCOP(saldoFinal)}
            `;
            
            document.getElementById('formula4').innerHTML = `
                <strong>Tasa mensual:</strong> ${(tasaMensual * 100).toFixed(4)}%<br>
                <strong>F√≥rmula:</strong> VF = VP √ó (1 + i)^n
            `;
            
            document.getElementById('result4').style.display = 'block';
            document.getElementById('formula4').style.display = 'block';
        }

        // Problema 5: Inter√©s compuesto variable
        function calcularProblema5() {
            const inversionInicial = parseFloat(document.getElementById('inversion5').value) * 1000000;
            
            // Tasas y per√≠odos
            const tasa1 = 0.10 / 4; // 10% anual trimestral por 2 a√±os
            const tasa2 = 0.12 / 4; // 12% anual trimestral por 1.5 a√±os
            const tasa3 = 0.14 / 4; // 14% anual trimestral por 1.5 a√±os
            
            // C√°lculo por per√≠odos
            let montoActual = inversionInicial;
            
            // Primeros 2 a√±os (8 trimestres) al 10%
            montoActual *= Math.pow(1 + tasa1, 8);
            const montoAno2 = montoActual;
            
            // Siguiente 1.5 a√±os (6 trimestres) al 12%
            montoActual *= Math.pow(1 + tasa2, 6);
            const montoAno35 = montoActual;
            
            // √öltimo 1.5 a√±os (6 trimestres) al 14%
            montoActual *= Math.pow(1 + tasa3, 6);
            const montoFinal = montoActual;
            
            document.getElementById('result5').innerHTML = `
                <strong>Inversi√≥n inicial:</strong> ${formatoCOP(inversionInicial)}<br>
                <strong>Monto a 2 a√±os (10%):</strong> ${formatoCOP(montoAno2)}<br>
                <strong>Monto a 3.5 a√±os (12%):</strong> ${formatoCOP(montoAno35)}<br>
                <strong>Monto final a 5 a√±os (14%):</strong> ${formatoCOP(montoFinal)}
            `;
            
            document.getElementById('formula5').innerHTML = `
                <strong>F√≥rmulas aplicadas:</strong><br>
                ‚Ä¢ A√±os 1-2: VF = ${formatoCOP(inversionInicial)} √ó (1 + ${(tasa1*100).toFixed(2)}%)^8<br>
                ‚Ä¢ A√±os 2-3.5: VF = ${formatoCOP(montoAno2)} √ó (1 + ${(tasa2*100).toFixed(2)}%)^6<br>
                ‚Ä¢ A√±os 3.5-5: VF = ${formatoCOP(montoAno35)} √ó (1 + ${(tasa3*100).toFixed(2)}%)^6
            `;
            
            document.getElementById('result5').style.display = 'block';
            document.getElementById('formula5').style.display = 'block';
        }

        // Problema 6: Valor presente de pr√©stamo
        function calcularProblema6() {
            const valorFinal = parseFloat(document.getElementById('valorFinal6').value) * 1000000;
            const tasaMensual = parseFloat(document.getElementById('tasaMensual6').value) / 100;
            const tiempo = parseFloat(document.getElementById('tiempo6').value);
            const meses = tiempo * 12;
            
            // Calcular valor presente
            const valorPrestamo = valorFinal / Math.pow(1 + tasaMensual, meses);
            
            document.getElementById('result6').innerHTML = `
                <strong>Valor del pr√©stamo original:</strong> ${formatoCOP(valorPrestamo)}<br>
                <strong>Monto pagado:</strong> ${formatoCOP(valorFinal)}<br>
                <strong>Intereses totales:</strong> ${formatoCOP(valorFinal - valorPrestamo)}
            `;
            
            document.getElementById('formula6').innerHTML = `
                <strong>F√≥rmula:</strong> VP = VF / (1 + i)^n<br>
                VP = ${formatoCOP(valorFinal)} / (1 + ${tasaMensual*100}%)^${meses}<br>
                <strong>Tasa efectiva anual:</strong> ${((Math.pow(1 + tasaMensual, 12) - 1) * 100).toFixed(2)}%
            `;
            
            document.getElementById('result6').style.display = 'block';
            document.getElementById('formula6').style.display = 'block';
        }

        // Problema 7: Equivalencia de tasas anticipadas
        function calcularProblema7() {
            // Tasas nominales anticipadas
            const tasas = [
                {periodo: 'Mensual', tasa: 0.0125, nombre: '1.25%'},
                {periodo: 'Bimensual', tasa: 0.0215, nombre: '2.15%'},
                {periodo: 'Trimestral', tasa: 0.0325, nombre: '3.25%'},
                {periodo: 'Semestral', tasa: 0.0645, nombre: '6.45%'}
            ];
            
            let resultados = [];
            
            tasas.forEach(item => {
                // Convertir tasa anticipada a vencida
                let tasaVencida;
                if (item.periodo === 'Mensual') {
                    tasaVencida = item.tasa / (1 - item.tasa);
                    resultados.push(`${item.periodo}: ${(tasaVencida * 100).toFixed(4)}%`);
                } else if (item.periodo === 'Bimensual') {
                    tasaVencida = item.tasa / (1 - item.tasa);
                    // Convertir a mensual
                    const tasaMensual = Math.pow(1 + tasaVencida, 1/2) - 1;
                    resultados.push(`${item.periodo}: ${(tasaMensual * 100).toFixed(4)}% mensual`);
                } else if (item.periodo === 'Trimestral') {
                    tasaVencida = item.tasa / (1 - item.tasa);
                    // Convertir a mensual
                    const tasaMensual = Math.pow(1 + tasaVencida, 1/3) - 1;
                    resultados.push(`${item.periodo}: ${(tasaMensual * 100).toFixed(4)}% mensual`);
                } else if (item.periodo === 'Semestral') {
                    tasaVencida = item.tasa / (1 - item.tasa);
                    // Convertir a mensual
                    const tasaMensual = Math.pow(1 + tasaVencida, 1/6) - 1;
                    resultados.push(`${item.periodo}: ${(tasaMensual * 100).toFixed(4)}% mensual`);
                }
            });
            
            document.getElementById('result7').innerHTML = `
                <strong>Tasas efectivas mensuales equivalentes:</strong><br>
                ${resultados.join('<br>')}
            `;
            
            document.getElementById('formula7').innerHTML = `
                <strong>F√≥rmula conversi√≥n anticipada a vencida:</strong><br>
                i_vencida = i_anticipada / (1 - i_anticipada)<br>
                <strong>F√≥rmula equivalencia de per√≠odos:</strong><br>
                i_equiv = (1 + i)^(1/n) - 1
            `;
            
            document.getElementById('result7').style.display = 'block';
            document.getElementById('formula7').style.display = 'block';
        }

        // Problema 8: C√°lculo de tasa de inter√©s
        function calcularProblema8() {
            const capitalInicial = parseFloat(document.getElementById('capitalInicial8').value) * 1000000;
            const capitalFinal = parseFloat(document.getElementById('capitalFinal8').value) * 1000000;
            const tiempo = parseFloat(document.getElementById('tiempo8').value);
            
            // Calcular tasa de inter√©s
            const tasa = Math.pow(capitalFinal / capitalInicial, 1/tiempo) - 1;
            const tasaAnual = tasa * 100;
            
            // Verificaci√≥n
            const verificacion = capitalInicial * Math.pow(1 + tasa, tiempo);
            
            document.getElementById('result8').innerHTML = `
                <strong>Tasa de inter√©s anual:</strong> ${tasaAnual.toFixed(4)}%<br>
                <strong>Verificaci√≥n:</strong> ${formatoCOP(verificacion)}<br>
                <strong>Intereses ganados:</strong> ${formatoCOP(capitalFinal - capitalInicial)}
            `;
            
            document.getElementById('formula8').innerHTML = `
                <strong>F√≥rmula:</strong> i = (VF/VP)^(1/n) - 1<br>
                i = (${formatoCOP(capitalFinal)}/${formatoCOP(capitalInicial)})^(1/${tiempo}) - 1<br>
                i = (${(capitalFinal/capitalInicial).toFixed(4)})^(${(1/tiempo).toFixed(4)}) - 1
            `;
            
            document.getElementById('result8').style.display = 'block';
            document.getElementById('formula8').style.display = 'block';
        }

        // Problema 9: Equivalencia de tasas efectivas
        function calcularProblema9() {
            const tasas = [
                {nombre: 'Mensual', tasa: 0.0135, periodos: 1},
                {nombre: 'Bimensual', tasa: 0.024, periodos: 2},
                {nombre: 'Trimestral', tasa: 0.036, periodos: 3},
                {nombre: 'Semestral', tasa: 0.067, periodos: 6}
            ];
            
            let resultados = [];
            
            tasas.forEach(item => {
                // Convertir a tasa efectiva trimestral
                const tasaTrimestral = Math.pow(1 + item.tasa, 3/item.periodos) - 1;
                resultados.push(`${item.nombre} (${(item.tasa*100)}%): ${(tasaTrimestral*100).toFixed(4)}%`);
            });
            
            document.getElementById('result9').innerHTML = `
                <strong>Tasas efectivas trimestrales equivalentes:</strong><br>
                ${resultados.join('<br>')}
            `;
            
            document.getElementById('formula9').innerHTML = `
                <strong>F√≥rmula de equivalencia:</strong><br>
                i_trimestral = (1 + i_original)^(3/n) - 1<br>
                Donde n = n√∫mero de meses del per√≠odo original
            `;
            
            document.getElementById('result9').style.display = 'block';
            document.getElementById('formula9').style.display = 'block';
        }

        // Problema 10: Dep√≥sito a t√©rmino fijo
        function calcularProblema10() {
            const inversion = parseFloat(document.getElementById('inversion10').value) * 1000000;
            const tasaSemestral = parseFloat(document.getElementById('tasaSemestral10').value) / 100;
            const tiempo = parseFloat(document.getElementById('tiempo10').value);
            const semestres = tiempo * 2;
            
            // Calcular valor futuro
            const valorFinal = inversion * Math.pow(1 + tasaSemestral, semestres);
            const interesesGanados = valorFinal - inversion;
            
            // Tasa efectiva anual
            const tasaAnual = Math.pow(1 + tasaSemestral, 2) - 1;
            
            document.getElementById('result10').innerHTML = `
                <strong>Valor a recibir:</strong> ${formatoCOP(valorFinal)}<br>
                <strong>Inversi√≥n inicial:</strong> ${formatoCOP(inversion)}<br>
                <strong>Intereses ganados:</strong> ${formatoCOP(interesesGanados)}<br>
                <strong>Rentabilidad total:</strong> ${((valorFinal/inversion - 1) * 100).toFixed(2)}%
            `;
            
            document.getElementById('formula10').innerHTML = `
                <strong>F√≥rmula:</strong> VF = VP √ó (1 + i)^n<br>
                VF = ${formatoCOP(inversion)} √ó (1 + ${tasaSemestral*100}%)^${semestres}<br>
                <strong>Tasa efectiva anual:</strong> ${(tasaAnual*100).toFixed(4)}%
            `;
            
            document.getElementById('result10').style.display = 'block';
            document.getElementById('formula10').style.display = 'block';
        }

        // Funci√≥n para descargar Excel
        function descargarExcel() {
            // Crear contenido CSV con todas las f√≥rmulas
            let csvContent = "Problema,Descripci√≥n,F√≥rmula,Resultado\n";
            
            // Agregar datos de cada problema
            csvContent += "1,Inter√©s Simple Dep√≥sitos,M = C(1 + it),Ver calculadora\n";
            csvContent += "2,An√°lisis Ofertas,VP = CF/(1+i)^t,Ver calculadora\n";
            csvContent += "3,Ahorro Maquinaria,VP = VF/(1+i)^n,Ver calculadora\n";
            csvContent += "4,Cuenta Movimientos,VF = VP(1+i)^n,Ver calculadora\n";
            csvContent += "5,Inter√©s Compuesto Variable,VF = VP(1+i1)^n1(1+i2)^n2,Ver calculadora\n";
            csvContent += "6,Valor Presente Pr√©stamo,VP = VF/(1+i)^n,Ver calculadora\n";
            csvContent += "7,Tasas Anticipadas,i_v = i_a/(1-i_a),Ver calculadora\n";
            csvContent += "8,C√°lculo Tasa,i = (VF/VP)^(1/n) - 1,Ver calculadora\n";
            csvContent += "9,Equivalencia Tasas,i_eq = (1+i)^(t2/t1) - 1,Ver calculadora\n";
            csvContent += "10,Dep√≥sito T√©rmino Fijo,VF = VP(1+i)^n,Ver calculadora\n";
            
            // Crear y descargar archivo
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Taller_Financiero.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            alert('üì• Archivo CSV descargado. Puedes abrirlo en Excel para ver las f√≥rmulas.');
        }

        // Funci√≥n para exportar resultados
        function exportarResultados() {
            let resultados = "TALLER DE MATEM√ÅTICAS FINANCIERAS\n";
            resultados += "=====================================\n\n";
            
            for(let i = 1; i <= 10; i++) {
                const resultDiv = document.getElementById(`result${i}`);
                if(resultDiv && resultDiv.style.display !== 'none') {
                    resultados += `PROBLEMA ${i}:\n`;
                    resultados += resultDiv.textContent + "\n\n";
                }
            }
            
            const blob = new Blob([resultados], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'Resultados_Taller_Financiero.txt';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            alert('üìä Resultados exportados exitosamente.');
        }

        // Calcular todos los problemas al cargar la p√°gina
        window.onload = function() {
            // Auto-calcular algunos ejemplos
            setTimeout(() => {
                calcularProblema1();
                calcularProblema7();
                calcularProblema9();
            }, 1000);
        };
    </script>
</body>
</html>